<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contacto</title>
  <link rel="stylesheet" href="./style.css?v=2">
  <style>
    .logo{display:block;margin:0 auto;width:35%}
    .backup-link{text-align:center;font-size:.95rem;margin-top:15px}
    .backup-link a{color:#102598;text-decoration:none;font-weight:bold}
    .backup-link a:hover{text-decoration:underline}
    iframe{border:none;width:100%;height:1251px}
  </style>
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0"/>
  <meta http-equiv="Pragma" content="no-cache"/>
</head>
<body>
  <div class="container">
    <img src="./CartoMicro.png" alt="Logo de la Empresa" class="logo">
    <h2 id="contact-name"></h2>

    <a href="#" id="download-link" class="download-button" style="display:none">Descargar Contacto (vCard)</a>

    <div class="form-container">
      <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScIaM7bWHOOK9Lj5NY0d8L-opXk8T8exEYmf6SuKRmrefAeSA/viewform?embedded=true">Cargando‚Ä¶</iframe>
    </div>

    <p class="backup-link">
      üìã Si no ves el formulario,
      <a href="https://docs.google.com/forms/d/e/1FAIpQLScIaM7bWHOOK9Lj5NY0d8L-opXk8T8exEYmf6SuKRmrefAeSA/viewform" target="_blank">√°brelo directamente</a>.
    </p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const users = {
        jsosa:       { name: "Ing. Jes√∫s Manuel Sosa V√°zquez",        vcf: "./jsosa.vcf" },
        jrodriguez:  { name: "Lic. Javier Rodr√≠guez Bravo",           vcf: "./jrodriguez.vcf" },
        lgonzalez:   { name: "Ing. Luis Gerardo Gonz√°lez Padilla",    vcf: "./lgonzalez.vcf" },
        lvillanueva: { name: "Ing. Luis Felipe Villanueva Gonz√°lez",  vcf: "./lvillanueva.vcf" }
      };

      // Lee y normaliza el par√°metro ?user=
      const qs = new URLSearchParams(window.location.search);
      const raw = qs.get('user') || qs.get('u') || '';
      const userKey = raw.trim().toLowerCase();

      const contactNameEl = document.getElementById('contact-name');
      const downloadLinkEl = document.getElementById('download-link');

      if (userKey && users[userKey]) {
        const u = users[userKey];
        document.title = `Contacto - ${u.name}`;
        contactNameEl.textContent = u.name;
        downloadLinkEl.href = u.vcf + `?v=2`; // cache-buster
        downloadLinkEl.style.display = 'inline-block';
      } else {
        document.title = "Contacto no encontrado";
        contactNameEl.textContent = "Por favor, escanee un c√≥digo QR v√°lido.";
      }
    });
  </script>
</body>
</html>
